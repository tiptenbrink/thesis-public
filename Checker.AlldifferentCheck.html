<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="./coqdocjs/resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="./coqdocjs/resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="./coqdocjs/resources/config.js"></script>
<script type="text/javascript" src="./coqdocjs/resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://redirect.tipten.nl/checker-project/">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Checker.AlldifferentCheck</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Bool.Bool.html#"><span class="id" title="library">Bool</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#"><span class="id" title="library">String</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Checker.Spec.html#"><span class="id" title="library">Checker.Spec</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Spec.html#ProofFacts"><span class="id" title="module">Spec.ProofFacts</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Spec.html#ConstraintDefinitions"><span class="id" title="module">Spec.ConstraintDefinitions</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Checker.Utility.html#"><span class="id" title="library">Utility</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Utility.html#Sets"><span class="id" title="module">Utility.Sets</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Utility.html#Maps"><span class="id" title="module">Utility.Maps</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Utility.html#ZRange"><span class="id" title="module">Utility.ZRange</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Utility.html#ListEx"><span class="id" title="module">Utility.ListEx</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Utility.html#ListInd"><span class="id" title="module">Utility.ListInd</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Utility.html#SubList"><span class="id" title="module">Utility.SubList</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Zext.html#"><span class="id" title="library">Checker.Zext</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Domain.html#"><span class="id" title="library">Checker.Domain</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Checker.DomainVar.html#"><span class="id" title="library">Checker.DomainVar</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Checker.Deduction.html#"><span class="id" title="library">Checker.Deduction</span></a>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1"></a><h1 class="section">Core proof.</h1>
 The below section is fully independent from the checker's implementation. It highlights the main idea on which the checker is based: there is no solution to an alldifferent constraint (given a current state of variable domains) if we can find variables such that the union of their domains is smaller than the number of variables. These are 'tight sets' according to the language of Van Hoeve (2001). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="MaterializedDomain" class="idref" href="#MaterializedDomain"><span class="id" title="definition">MaterializedDomain</span></a> := <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="state" class="idref" href="#state"><span class="id" title="definition">state</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#MaterializedDomain"><span class="id" title="definition">MaterializedDomain</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="valuation_in_state" class="idref" href="#valuation_in_state"><span class="id" title="definition">valuation_in_state</span></a> (<a id="st:1" class="idref" href="#st:1"><span class="id" title="binder">st</span></a> : <a class="idref" href="Checker.AlldifferentCheck.html#state"><span class="id" title="definition">state</span></a>) (<a id="vs:2" class="idref" href="#vs:2"><span class="id" title="binder">vs</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="v:3" class="idref" href="#v:3"><span class="id" title="binder">v</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="x:4" class="idref" href="#x:4"><span class="id" title="binder">x</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:4"><span class="id" title="variable">x</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vs:2"><span class="id" title="variable">vs</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#v:3"><span class="id" title="variable">v</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:4"><span class="id" title="variable">x</span></a>) (<a class="idref" href="Checker.AlldifferentCheck.html#st:1"><span class="id" title="variable">st</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:4"><span class="id" title="variable">x</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Alldifferent_l" class="idref" href="#Alldifferent_l"><span class="id" title="definition">Alldifferent_l</span></a> (<a id="vs:5" class="idref" href="#vs:5"><span class="id" title="binder">vs</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="sol:6" class="idref" href="#sol:6"><span class="id" title="binder">sol</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="x:7" class="idref" href="#x:7"><span class="id" title="binder">x</span></a> <a id="y:8" class="idref" href="#y:8"><span class="id" title="binder">y</span></a>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:7"><span class="id" title="variable">x</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vs:5"><span class="id" title="variable">vs</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:8"><span class="id" title="variable">y</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vs:5"><span class="id" title="variable">vs</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.AlldifferentCheck.html#sol:6"><span class="id" title="variable">sol</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:7"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#sol:6"><span class="id" title="variable">sol</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:8"><span class="id" title="variable">y</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="AllDifferent_sat" class="idref" href="#AllDifferent_sat"><span class="id" title="definition">AllDifferent_sat</span></a> (<a id="st:9" class="idref" href="#st:9"><span class="id" title="binder">st</span></a> : <a class="idref" href="Checker.AlldifferentCheck.html#state"><span class="id" title="definition">state</span></a>) (<a id="vs:10" class="idref" href="#vs:10"><span class="id" title="binder">vs</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="v:11" class="idref" href="#v:11"><span class="id" title="binder">v</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#valuation_in_state"><span class="id" title="definition">valuation_in_state</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#st:9"><span class="id" title="variable">st</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vs:10"><span class="id" title="variable">vs</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#v:11"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#Alldifferent_l"><span class="id" title="definition">Alldifferent_l</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vs:10"><span class="id" title="variable">vs</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#v:11"><span class="id" title="variable">v</span></a>.<br/>

<br/>
</div>

<div class="doc">
Copied from Coq stdlib 9.0 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="Injective_map_NoDup_in" class="idref" href="#Injective_map_NoDup_in"><span class="id" title="lemma">Injective_map_NoDup_in</span></a> <a id="A:12" class="idref" href="#A:12"><span class="id" title="binder">A</span></a> <a id="B:13" class="idref" href="#B:13"><span class="id" title="binder">B</span></a> (<a id="f:14" class="idref" href="#f:14"><span class="id" title="binder">f</span></a>:<a class="idref" href="Checker.AlldifferentCheck.html#A:12"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Checker.AlldifferentCheck.html#B:13"><span class="id" title="variable">B</span></a>) (<a id="l:15" class="idref" href="#l:15"><span class="id" title="binder">l</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#A:12"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="x:16" class="idref" href="#x:16"><span class="id" title="binder">x</span></a> <a id="y:17" class="idref" href="#y:17"><span class="id" title="binder">y</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:16"><span class="id" title="variable">x</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#l:15"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:17"><span class="id" title="variable">y</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#l:15"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#f:14"><span class="id" title="variable">f</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:16"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#f:14"><span class="id" title="variable">f</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:17"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:16"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:17"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#l:15"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#f:14"><span class="id" title="variable">f</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#l:15"><span class="id" title="variable">l</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> @<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_cons"><span class="id" title="lemma">in_cons</span></a>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> @<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_eq"><span class="id" title="lemma">in_eq</span></a>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ij</span> <span class="id" title="var">N</span>; <span class="id" title="var">revert</span> <span class="id" title="var">Ij</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">N</span>; <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a>]; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_map_iff"><span class="id" title="lemma">in_map_iff</span></a>. <span class="id" title="tactic">intros</span> (<span class="id" title="var">y</span> &amp; <span class="id" title="var">E</span> &amp; <span class="id" title="var">Y</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">Ij</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
This is the main lemma that underpins the approach. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="alldiff_conflict_if_union_lt_vars" class="idref" href="#alldiff_conflict_if_union_lt_vars"><span class="id" title="lemma">alldiff_conflict_if_union_lt_vars</span></a> (<a id="st:18" class="idref" href="#st:18"><span class="id" title="binder">st</span></a> : <a class="idref" href="Checker.AlldifferentCheck.html#state"><span class="id" title="definition">state</span></a>) (<a id="vars:19" class="idref" href="#vars:19"><span class="id" title="binder">vars</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="domain_union:20" class="idref" href="#domain_union:20"><span class="id" title="binder">domain_union</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#domain_union:20"><span class="id" title="variable">domain_union</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vars:19"><span class="id" title="variable">vars</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="n:21" class="idref" href="#n:21"><span class="id" title="binder">n</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:21"><span class="id" title="variable">n</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#domain_union:20"><span class="id" title="variable">domain_union</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="x:22" class="idref" href="#x:22"><span class="id" title="binder">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:22"><span class="id" title="variable">x</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vars:19"><span class="id" title="variable">vars</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:21"><span class="id" title="variable">n</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#st:18"><span class="id" title="variable">st</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:22"><span class="id" title="variable">x</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#domain_union:20"><span class="id" title="variable">domain_union</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vars:19"><span class="id" title="variable">vars</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#AllDifferent_sat"><span class="id" title="definition">AllDifferent_sat</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#st:18"><span class="id" title="variable">st</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vars:19"><span class="id" title="variable">vars</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hunion_nd</span> <span class="id" title="var">Hvars_nd</span> <span class="id" title="var">Hunion</span> <span class="id" title="var">Hlengths</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">A</span> [<span class="id" title="var">Hastate</span> <span class="id" title="var">Halldiff</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <span class="id" title="var">domain_union</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f9"><span class="id" title="notation">&gt;=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <span class="id" title="var">vars</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Hlengths</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length_map"><span class="id" title="lemma">length_map</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> := <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup_incl_length"><span class="id" title="lemma">NoDup_incl_length</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> -<span class="id" title="var">Hvars_nd</span> <span class="id" title="var">Halldiff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Checker.AlldifferentCheck.html#Injective_map_NoDup_in"><span class="id" title="lemma">Injective_map_NoDup_in</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">Hxin</span> <span class="id" title="var">Hyin</span> <span class="id" title="var">Hxy_A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">A</span> <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">A</span> <span class="id" title="var">y</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">contradiction</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Hxy_A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Halldiff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hxin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hyin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">Hvars_nd</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_map_iff"><span class="id" title="lemma">in_map_iff</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">x</span> &amp; <span class="id" title="var">Hx_A</span> &amp; <span class="id" title="var">Hxin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hunion</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">Hxin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hx_A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hastate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Hxin</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab2"></a><h1 class="section">Domain materialization</h1>
 We choose a simple approach for determining the union of a series of domains: we first materialize them by building a set of all elements and then merge these. Another, potentially faster, approach would be to determine the intersection of all holes and and use the min and max of the lower and upper bounds to construct a new Domain. If we seek to verify only range consistent propagators, we could skip the more expensive hole intersection step. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Domain_scope</span>.<br/>

<br/>
</div>

<div class="doc">
This is not the most efficient way to materialize it, as first we build a range, then turn it into a set and then remove the holes one by one, but for alldifferent we mostly care that it works. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="materialize_dom" class="idref" href="#materialize_dom"><span class="id" title="definition">materialize_dom</span></a> (<a id="dom:23" class="idref" href="#dom:23"><span class="id" title="binder">dom</span></a> : <a class="idref" href="Checker.Domain.html#Domain"><span class="id" title="record">Domain</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Checker.Domain.html#lb_ub_from_dom"><span class="id" title="definition">lb_ub_from_dom</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#dom:23"><span class="id" title="variable">dom</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">lb</span><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">ub</span><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="values:24" class="idref" href="#values:24"><span class="id" title="binder">values</span></a> := <a class="idref" href="Checker.Utility.html#ZRange.range"><span class="id" title="definition">range</span></a> <span class="id" title="var">lb</span> <span class="id" title="var">ub</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="values_set:25" class="idref" href="#values_set:25"><span class="id" title="binder">values_set</span></a> := <a class="idref" href="Checker.Utility.html#Sets.sint.build"><span class="id" title="definition">sint.build</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#values:24"><span class="id" title="variable">values</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Checker.Utility.html#Sets.sint.fold"><span class="id" title="definition">sint.fold</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.remove"><span class="id" title="definition">sint.remove</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#dom:23"><span class="id" title="variable">dom</span></a>.(<a class="idref" href="Checker.Domain.html#d_holes"><span class="id" title="projection">d_holes</span></a>)<a class="idref" href="Checker.AlldifferentCheck.html#values_set:25"><span class="id" title="variable">values_set</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_bounded" class="idref" href="#is_bounded"><span class="id" title="definition">is_bounded</span></a> (<a id="dom:26" class="idref" href="#dom:26"><span class="id" title="binder">dom</span></a> : <a class="idref" href="Checker.Domain.html#Domain"><span class="id" title="record">Domain</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Checker.Domain.html#lb_ub_from_dom"><span class="id" title="definition">lb_ub_from_dom</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#dom:26"><span class="id" title="variable">dom</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
This lemma captures the correctness of the procedure of the materialize_dom procedure. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="materialize_dom_iff_in_dom" class="idref" href="#materialize_dom_iff_in_dom"><span class="id" title="lemma">materialize_dom_iff_in_dom</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="y:27" class="idref" href="#y:27"><span class="id" title="binder">y</span></a> <a id="dom:28" class="idref" href="#dom:28"><span class="id" title="binder">dom</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.AlldifferentCheck.html#is_bounded"><span class="id" title="definition">is_bounded</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#dom:28"><span class="id" title="variable">dom</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Domain.html#is_in_dom"><span class="id" title="definition">is_in_dom</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:27"><span class="id" title="variable">y</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#dom:28"><span class="id" title="variable">dom</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:27"><span class="id" title="variable">y</span></a> (<a class="idref" href="Checker.Utility.html#ListEx.option_default"><span class="id" title="definition">option_default</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.empty"><span class="id" title="definition">sint.empty</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#dom:28"><span class="id" title="variable">dom</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">dom</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#is_bounded"><span class="id" title="definition">is_bounded</span></a>, <a class="idref" href="Checker.Domain.html#is_in_dom"><span class="id" title="definition">is_in_dom</span></a>, <a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a>, <a class="idref" href="Checker.Domain.html#lb_ub_from_dom"><span class="id" title="definition">lb_ub_from_dom</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.Domain.html#d_lb"><span class="id" title="projection">d_lb</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">lb</span>| |]; <span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.Domain.html#d_ub"><span class="id" title="projection">d_ub</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">ub</span>| |]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">zext_as_z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.Utility.html#Sets.sint.elements_in"><span class="id" title="lemma">sint.elements_in</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#Sets.sint.fold_spec"><span class="id" title="lemma">sint.fold_spec</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#fold_left_rev_right"><span class="id" title="lemma">fold_left_rev_right</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="Checker.Utility.html#Sets.sint.elements"><span class="id" title="definition">sint.elements</span></a> (<a class="idref" href="Checker.Domain.html#d_holes"><span class="id" title="projection">d_holes</span></a> <span class="id" title="var">dom</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">holes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Heqholes</span> <span class="id" title="var">dom</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">P</span> := <span class="id" title="keyword">fun</span> (<a id="holes:29" class="idref" href="#holes:29"><span class="id" title="binder"><span id="holes:32" class="id">holes</span></span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<a id="acc:30" class="idref" href="#acc:30"><span class="id" title="binder"><span id="acc:33" class="id">acc</span></span></a> : <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="y:31" class="idref" href="#y:31"><span class="id" title="binder"><span id="y:34" class="id">y</span></span></a>, (<span class="id" title="var">lb</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:31"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:31"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="var">ub</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:31"><span class="id" title="variable">y</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#holes:29"><span class="id" title="variable">holes</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:31"><span class="id" title="variable">y</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#acc:30"><span class="id" title="variable">acc</span></a>)%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">P</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">holes</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.remove"><span class="id" title="definition">sint.remove</span></a> (<a class="idref" href="Checker.Utility.html#Sets.sint.build"><span class="id" title="definition">sint.build</span></a> (<a class="idref" href="Checker.Utility.html#ZRange.range"><span class="id" title="definition">range</span></a> <span class="id" title="var">lb</span> <span class="id" title="var">ub</span>)) (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">holes</span>))).<br/>
&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_rev"><span class="id" title="lemma">in_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Checker.Utility.html#ListInd.fold_ind"><span class="id" title="lemma">fold_ind</span></a>; <span class="id" title="tactic">clear</span> <span class="id" title="var">holes</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#Sets.sint.build_spec"><span class="id" title="lemma">sint.build_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.Utility.html#ZRange.in_range"><span class="id" title="lemma">in_range</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hnil</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hnil</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">values</span> <span class="id" title="var">holes</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#Sets.sint.remove_spec"><span class="id" title="lemma">sint.remove_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">y</span> (<span class="id" title="var">h</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">holes</span>) <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">h</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">y</span> <span class="id" title="var">holes</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Hyh</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hyh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">Hnyh</span> <span class="id" title="var">Hnin</span>] [<span class="id" title="var">Hhy</span> | <span class="id" title="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span> <span class="id" title="var">y</span>. <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contradiction</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Given a domain map, we want to get the materialized domain corresponding to a var. We ignore constants, so if we have constants in our alldifferent constraint it might not completely work. It should be possible to add support by simply returning a singleton set containing the constant in that case, but we do not do that here. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="materialized_dom_for_var" class="idref" href="#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a> (<a id="doms:35" class="idref" href="#doms:35"><span class="id" title="binder">doms</span></a>: <a class="idref" href="Checker.DomainVar.html#Domains"><span class="id" title="definition">Domains</span></a>) (<a id="var:36" class="idref" href="#var:36"><span class="id" title="binder">var</span></a> : <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.Var"><span class="id" title="inductive">Var</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Checker.AlldifferentCheck.html#var:36"><span class="id" title="variable">var</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Checker.Utility.html#Maps.smap.find"><span class="id" title="definition">smap.find</span></a> <span class="id" title="var">x</span> <a class="idref" href="Checker.AlldifferentCheck.html#doms:35"><span class="id" title="variable">doms</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">dom</span> =&gt; <a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a> <span class="id" title="var">dom</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="in_materialized_iff_in_dom_for_var" class="idref" href="#in_materialized_iff_in_dom_for_var"><span class="id" title="lemma">in_materialized_iff_in_dom_for_var</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="n:38" class="idref" href="#n:38"><span class="id" title="binder">n</span></a> <a id="s:39" class="idref" href="#s:39"><span class="id" title="binder">s</span></a> <a id="doms:40" class="idref" href="#doms:40"><span class="id" title="binder">doms</span></a> <a id="x:41" class="idref" href="#x:41"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.AlldifferentCheck.html#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#doms:40"><span class="id" title="variable">doms</span></a> (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:41"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#s:39"><span class="id" title="variable">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:38"><span class="id" title="variable">n</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#s:39"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:38"><span class="id" title="variable">n</span></a> (<a class="idref" href="Checker.Utility.html#ListEx.option_default"><span class="id" title="definition">option_default</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.empty"><span class="id" title="definition">sint.empty</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#doms:40"><span class="id" title="variable">doms</span></a> <a class="idref" href="Checker.DomainVar.html#::Domain_scope:x_'d-&gt;'_x"><span class="id" title="notation">d</span></a><a class="idref" href="Checker.DomainVar.html#::Domain_scope:x_'d-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:41"><span class="id" title="variable">x</span></a>)))<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">s</span> <span class="id" title="var">doms</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a>, <a class="idref" href="Checker.DomainVar.html#dom_from_domains"><span class="id" title="definition">dom_from_domains</span></a>, <a class="idref" href="Checker.Utility.html#ListEx.option_default"><span class="id" title="definition">option_default</span></a>, <a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.Utility.html#Maps.smap.find"><span class="id" title="definition">smap.find</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">dom</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hfind</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.Domain.html#lb_ub_from_dom"><span class="id" title="definition">lb_ub_from_dom</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">lb</span> <span class="id" title="var">ub</span>]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="materialize_vars_doms" class="idref" href="#materialize_vars_doms"><span class="id" title="definition">materialize_vars_doms</span></a> (<a id="vars:42" class="idref" href="#vars:42"><span class="id" title="binder">vars</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.Var"><span class="id" title="inductive">Var</span></a>) (<a id="doms:43" class="idref" href="#doms:43"><span class="id" title="binder">doms</span></a> : <a class="idref" href="Checker.DomainVar.html#Domains"><span class="id" title="definition">Domains</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="Checker.Utility.html#ListEx.flat_map_option"><span class="id" title="definition">flat_map_option</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#doms:43"><span class="id" title="variable">doms</span></a>) <a class="idref" href="Checker.AlldifferentCheck.html#vars:42"><span class="id" title="variable">vars</span></a>.<br/>

<br/>
</div>

<div class="doc">
The below code could be moved to Utility.Sets as it is not specific to alldifferent. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="union_sets" class="idref" href="#union_sets"><span class="id" title="definition">union_sets</span></a> (<a id="sets:44" class="idref" href="#sets:44"><span class="id" title="binder">sets</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.union"><span class="id" title="definition">sint.union</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#sets:44"><span class="id" title="variable">sets</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.empty"><span class="id" title="definition">sint.empty</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="union_sets_spec" class="idref" href="#union_sets_spec"><span class="id" title="lemma">union_sets_spec</span></a> (<a id="sets:45" class="idref" href="#sets:45"><span class="id" title="binder">sets</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="n:46" class="idref" href="#n:46"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:46"><span class="id" title="variable">n</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#union_sets"><span class="id" title="definition">union_sets</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#sets:45"><span class="id" title="variable">sets</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="s:47" class="idref" href="#s:47"><span class="id" title="binder">s</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#s:47"><span class="id" title="variable">s</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#sets:45"><span class="id" title="variable">sets</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:46"><span class="id" title="variable">n</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#s:47"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#union_sets"><span class="id" title="definition">union_sets</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#fold_left_rev_right"><span class="id" title="lemma">fold_left_rev_right</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">P</span> := <span class="id" title="keyword">fun</span> (<a id="sets:48" class="idref" href="#sets:48"><span class="id" title="binder"><span id="sets:52" class="id">sets</span></span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a>) (<a id="acc:49" class="idref" href="#acc:49"><span class="id" title="binder"><span id="acc:53" class="id">acc</span></span></a> : <a class="idref" href="Checker.Utility.html#Sets.sint.t"><span class="id" title="definition">sint.t</span></a>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="n:50" class="idref" href="#n:50"><span class="id" title="binder"><span id="n:54" class="id">n</span></span></a>, <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:50"><span class="id" title="variable">n</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#acc:49"><span class="id" title="variable">acc</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="s:51" class="idref" href="#s:51"><span class="id" title="binder"><span id="s:55" class="id">s</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#s:51"><span class="id" title="variable">s</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#sets:48"><span class="id" title="variable">sets</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.In"><span class="id" title="definition">sint.In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#n:50"><span class="id" title="variable">n</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#s:51"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">P</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">sets</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> (<span class="id" title="keyword">fun</span> <a id="y:56" class="idref" href="#y:56"><span class="id" title="binder"><span id="y:58" class="id">y</span></span></a> <a id="x:57" class="idref" href="#x:57"><span class="id" title="binder"><span id="x:59" class="id">x</span></span></a> =&gt; <a class="idref" href="Checker.Utility.html#Sets.sint.union"><span class="id" title="definition">sint.union</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:57"><span class="id" title="variable">x</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#y:56"><span class="id" title="variable">y</span></a>) <a class="idref" href="Checker.Utility.html#Sets.sint.empty"><span class="id" title="definition">sint.empty</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">sets</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">P</span>. <span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_rev"><span class="id" title="lemma">in_rev</span></a> <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Checker.Utility.html#ListInd.fold_ind"><span class="id" title="lemma">fold_ind</span></a>; <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">P</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="Checker.Utility.html#Sets.sint.empty_spec"><span class="id" title="lemma">sint.empty_spec</span></a> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n'</span> [<span class="id" title="var">Hnil</span> <span class="id" title="var">_</span>]]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hnil</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">sets</span> <span class="id" title="var">IH</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#Sets.sint.union_spec"><span class="id" title="lemma">sint.union_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hin'</span> | <span class="id" title="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin'</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s_set</span> &amp; <span class="id" title="var">Hssets</span> &amp; <span class="id" title="var">Hin_s_set</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">s_set</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hssets</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hin_s_set</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#Sets.sint.union_spec"><span class="id" title="lemma">sint.union_spec</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s_set</span> &amp; <span class="id" title="var">Hssets</span> &amp; <span class="id" title="var">Hin_s_set</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hssets</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hs_set_s</span> | <span class="id" title="var">Hssets</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span> <span class="id" title="var">s_set</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hin_s_set</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">s_set</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hssets</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hin_s_set</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab3"></a><h1 class="section">Checker</h1>
 This is the actual checker. If assumptions are made using constant values in the constraint, we ignore them and they will not be checked. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="alldifferent_checker" class="idref" href="#alldifferent_checker"><span class="id" title="definition">alldifferent_checker</span></a> (<a id="fact:60" class="idref" href="#fact:60"><span class="id" title="binder">fact</span></a> : <a class="idref" href="Checker.Spec.html#ProofFacts.ProofFact"><span class="id" title="record">ProofFact</span></a>) (<a id="constraint:61" class="idref" href="#constraint:61"><span class="id" title="binder">constraint</span></a> : <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.AlldifferentConstraint"><span class="id" title="record">AlldifferentConstraint</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Checker.Deduction.html#infer_domains"><span class="id" title="definition">infer_domains</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#fact:60"><span class="id" title="variable">fact</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">domains</span><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="materialized_doms:62" class="idref" href="#materialized_doms:62"><span class="id" title="binder">materialized_doms</span></a> := <a class="idref" href="Checker.AlldifferentCheck.html#materialize_vars_doms"><span class="id" title="definition">materialize_vars_doms</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#constraint:61"><span class="id" title="variable">constraint</span></a>.(<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_variables"><span class="id" title="projection">diff_variables</span></a>) <span class="id" title="var">domains</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Utility.html#Sets.sint.cardinal"><span class="id" title="definition">sint.cardinal</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#union_sets"><span class="id" title="definition">union_sets</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#materialized_doms:62"><span class="id" title="variable">materialized_doms</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#materialized_doms:62"><span class="id" title="variable">materialized_doms</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
For efficiency, we do not explicitly compute the variables in the materialize_vars_doms, but we do want to reason about exactly which variables show will not be all different. First, we compute all variables with finite domains, as these are the only ones with a finite domain size that we can reason about. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="bounded_vars" class="idref" href="#bounded_vars"><span class="id" title="definition">bounded_vars</span></a> (<a id="doms:63" class="idref" href="#doms:63"><span class="id" title="binder">doms</span></a> : <a class="idref" href="Checker.DomainVar.html#Domains"><span class="id" title="definition">Domains</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="x:64" class="idref" href="#x:64"><span class="id" title="binder">x</span></a> =&gt; <a class="idref" href="Checker.AlldifferentCheck.html#is_bounded"><span class="id" title="definition">is_bounded</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#doms:63"><span class="id" title="variable">doms</span></a> <a class="idref" href="Checker.DomainVar.html#::Domain_scope:x_'d-&gt;'_x"><span class="id" title="notation">d</span></a><a class="idref" href="Checker.DomainVar.html#::Domain_scope:x_'d-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:64"><span class="id" title="variable">x</span></a>)) (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="Checker.Utility.html#Maps.smap.bindings"><span class="id" title="definition">smap.bindings</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#doms:63"><span class="id" title="variable">doms</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="same_ident" class="idref" href="#same_ident"><span class="id" title="definition">same_ident</span></a> (<a id="x:65" class="idref" href="#x:65"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="var:66" class="idref" href="#var:66"><span class="id" title="binder">var</span></a> : <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.Var"><span class="id" title="inductive">Var</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Checker.AlldifferentCheck.html#var:66"><span class="id" title="variable">var</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <span class="id" title="var">y</span> =&gt; (<a class="idref" href="Checker.AlldifferentCheck.html#x:65"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#5886275aa8d678ebe8bc38ad41c652c0"><span class="id" title="notation">=?</span></a> <span class="id" title="var">y</span>)%<span class="id" title="var">string</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
These are not used for computation, just for the proofs. In combination with bounded_vars they allow specifying exactly which variable domains are included in the domains of materialize_vars_doms. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="constr_vars" class="idref" href="#constr_vars"><span class="id" title="definition">constr_vars</span></a> (<a id="vs:68" class="idref" href="#vs:68"><span class="id" title="binder">vs</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<a id="constr:69" class="idref" href="#constr:69"><span class="id" title="binder">constr</span></a> : <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.AlldifferentConstraint"><span class="id" title="record">AlldifferentConstraint</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="x:70" class="idref" href="#x:70"><span class="id" title="binder">x</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#existsb"><span class="id" title="definition">existsb</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#same_ident"><span class="id" title="definition">same_ident</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:70"><span class="id" title="variable">x</span></a>) <a class="idref" href="Checker.AlldifferentCheck.html#constr:69"><span class="id" title="variable">constr</span></a>.(<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_variables"><span class="id" title="projection">diff_variables</span></a>)) <a class="idref" href="Checker.AlldifferentCheck.html#vs:68"><span class="id" title="variable">vs</span></a>.<br/>

<br/>
</div>

<div class="doc">
Here we show that bounded constraint variables will have a materialized domain. This connects what we do in the checker with the function we use to denote the actual variables in the conflict. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="materialized_in_constr_iff_in_constr_bounded" class="idref" href="#materialized_in_constr_iff_in_constr_bounded"><span class="id" title="lemma">materialized_in_constr_iff_in_constr_bounded</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="constr:71" class="idref" href="#constr:71"><span class="id" title="binder">constr</span></a> <a id="doms:72" class="idref" href="#doms:72"><span class="id" title="binder">doms</span></a> <a id="v:73" class="idref" href="#v:73"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#v:73"><span class="id" title="variable">v</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#constr:71"><span class="id" title="variable">constr</span></a>.(<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_variables"><span class="id" title="projection">diff_variables</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Checker.AlldifferentCheck.html#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#doms:72"><span class="id" title="variable">doms</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#v:73"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#v:73"><span class="id" title="variable">v</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#bounded_vars"><span class="id" title="definition">bounded_vars</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#doms:72"><span class="id" title="variable">doms</span></a>) <a class="idref" href="Checker.AlldifferentCheck.html#constr:71"><span class="id" title="variable">constr</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="keyword">constr</span> <span class="id" title="var">doms</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_map_iff"><span class="id" title="lemma">in_map_iff</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hvx</span>.<br/>
&nbsp;&nbsp;2: { <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">x</span> &amp; <span class="id" title="var">Hfalse</span> &amp; <span class="id" title="var">_</span>). <span class="id" title="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <span class="id" title="var">x</span>) (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_variables"><span class="id" title="projection">diff_variables</span></a> <span class="id" title="keyword">constr</span>) <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="keyword">match</span> <a class="idref" href="Checker.Utility.html#Maps.smap.find"><span class="id" title="definition">smap.find</span></a> <span class="id" title="var">x</span> <span class="id" title="var">doms</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">dom</span> =&gt; <a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a> <span class="id" title="var">dom</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">x</span> (<a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#bounded_vars"><span class="id" title="definition">bounded_vars</span></a> <span class="id" title="var">doms</span>) <span class="id" title="keyword">constr</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Henough</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Henough</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">x'</span> &amp; <span class="id" title="var">Hxx'</span> &amp; <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hxx'</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Henough</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a>, <a class="idref" href="Checker.AlldifferentCheck.html#bounded_vars"><span class="id" title="definition">bounded_vars</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter_In"><span class="id" title="lemma">filter_In</span></a>; <span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter_In"><span class="id" title="lemma">filter_In</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#is_bounded"><span class="id" title="definition">is_bounded</span></a>, <a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a>, <a class="idref" href="Checker.DomainVar.html#dom_from_domains"><span class="id" title="definition">dom_from_domains</span></a>, <a class="idref" href="Checker.Utility.html#ListEx.option_default"><span class="id" title="definition">option_default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#existsb_exists"><span class="id" title="lemma">existsb_exists</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.Utility.html#Maps.smap.find"><span class="id" title="definition">smap.find</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">dom</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hfind</span>.<br/>
&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.Domain.html#lb_ub_from_dom"><span class="id" title="definition">lb_ub_from_dom</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">lb</span> <span class="id" title="var">ub</span>]|]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_map_iff"><span class="id" title="lemma">in_map_iff</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">dom</span><a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#Maps.smap_in_spec"><span class="id" title="lemma">smap_in_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.Utility.html#Maps.smap.find_spec"><span class="id" title="lemma">smap.find_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Hfind</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#eqb_eq"><span class="id" title="lemma">String.eqb_eq</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; (<span class="id" title="var">v'</span> &amp; <span class="id" title="var">Hin</span> &amp; <span class="id" title="var">Hxv'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#same_ident"><span class="id" title="definition">same_ident</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hxv'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">v'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span>|]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#eqb_eq"><span class="id" title="lemma">String.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hxv'</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Hin</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The proof is a bit large because we aim to explicitly decouple the implementation details and the core idea of checking alldifferent. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="checker_alldifferent" class="idref" href="#checker_alldifferent"><span class="id" title="lemma">checker_alldifferent</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="fact:74" class="idref" href="#fact:74"><span class="id" title="binder">fact</span></a> <a id="sol:75" class="idref" href="#sol:75"><span class="id" title="binder">sol</span></a> <a id="constr:76" class="idref" href="#constr:76"><span class="id" title="binder">constr</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.Alldifferent"><span class="id" title="definition">Alldifferent</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#constr:76"><span class="id" title="variable">constr</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#sol:75"><span class="id" title="variable">sol</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#alldifferent_checker"><span class="id" title="definition">alldifferent_checker</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#fact:74"><span class="id" title="variable">fact</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#constr:76"><span class="id" title="variable">constr</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.Spec.html#ProofFacts.fact_valid"><span class="id" title="definition">fact_valid</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#sol:75"><span class="id" title="variable">sol</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#fact:74"><span class="id" title="variable">fact</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">fact</span> <span class="id" title="var">sol</span> <span class="id" title="keyword">constr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#alldifferent_checker"><span class="id" title="definition">alldifferent_checker</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.Deduction.html#infer_domains"><span class="id" title="definition">infer_domains</span></a> <span class="id" title="keyword">as</span> [(<span class="id" title="var">doms</span> &amp; <span class="id" title="var">cnsq</span>)|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hinfer</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Checker.Deduction.html#infer_domains_correct"><span class="id" title="lemma">infer_domains_correct</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">sol</span> := <span class="id" title="var">sol</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hinfer</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hinfer</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Hinfer</span> <span class="id" title="var">cnsq</span> <span class="id" title="var">fact</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Halldiff</span> <span class="id" title="var">Hconfl</span> <span class="id" title="var">Hin_doms</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="keyword">fun</span> <a id="x:77" class="idref" href="#x:77"><span class="id" title="binder"><span id="x:78" class="id">x</span></span></a> =&gt; <a class="idref" href="Checker.Utility.html#ListEx.option_default"><span class="id" title="definition">option_default</span></a> <a class="idref" href="Checker.Utility.html#Sets.sint.empty"><span class="id" title="definition">sint.empty</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom"><span class="id" title="definition">materialize_dom</span></a> (<span class="id" title="var">doms</span> <a class="idref" href="Checker.DomainVar.html#::Domain_scope:x_'d-&gt;'_x"><span class="id" title="notation">d</span></a><a class="idref" href="Checker.DomainVar.html#::Domain_scope:x_'d-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#x:77"><span class="id" title="variable">x</span></a>))) <span class="id" title="keyword">as</span> <span class="id" title="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.DomainVar.html#sol_in_doms"><span class="id" title="definition">sol_in_doms</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin_doms</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#bounded_vars"><span class="id" title="definition">bounded_vars</span></a> <span class="id" title="var">doms</span>) <span class="id" title="keyword">constr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">vars</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="Checker.AlldifferentCheck.html#valuation_in_state"><span class="id" title="definition">valuation_in_state</span></a> <span class="id" title="var">st</span> <span class="id" title="var">vars</span> <span class="id" title="var">sol</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hvars_in_state</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Heqst</span> <span class="id" title="var">Heqvars</span> <span class="id" title="var">Hin_doms</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">st</span> <span class="id" title="var">vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a>, <a class="idref" href="Checker.AlldifferentCheck.html#bounded_vars"><span class="id" title="definition">bounded_vars</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter_In"><span class="id" title="lemma">filter_In</span></a>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter_In"><span class="id" title="lemma">filter_In</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ((<span class="id" title="var">_</span> &amp; <span class="id" title="var">Hisbounded</span>) &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialize_dom_iff_in_dom"><span class="id" title="lemma">materialize_dom_iff_in_dom</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">y</span> := <span class="id" title="var">sol</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hisbounded</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hisbounded</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hin_doms</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hin_doms</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#Alldifferent_l"><span class="id" title="definition">Alldifferent_l</span></a> <span class="id" title="var">vars</span> <span class="id" title="var">sol</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Halldiff_l</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Halldiff</span> <span class="id" title="var">Halldiff_l</span> <span class="id" title="var">Heqvars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Halldiff_l</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Halldiff_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a>. <span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter_In"><span class="id" title="lemma">filter_In</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">_</span> <span class="id" title="var">Hexx</span>] [<span class="id" title="var">_</span> <span class="id" title="var">Hexy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Hexx</span> <span class="id" title="var">Hexy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#existsb_exists"><span class="id" title="lemma">existsb_exists</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">x'</span> &amp; <span class="id" title="var">Hx'</span>) (<span class="id" title="var">y'</span> &amp; <span class="id" title="var">Hy'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Hx'</span> <span class="id" title="var">Hy'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#same_ident"><span class="id" title="definition">same_ident</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">y'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">y'</span>|]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span>|]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#eqb_eq"><span class="id" title="lemma">String.eqb_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">Hinx</span> <span class="id" title="var">Hxx'</span>] [<span class="id" title="var">Hiny</span> <span class="id" title="var">Hyy'</span>]; <span class="id" title="tactic">subst</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Halldiff</span> (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <span class="id" title="var">x</span>) (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Halldiff</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Halldiff</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Halldiff</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#AllDifferent_sat"><span class="id" title="definition">AllDifferent_sat</span></a> <span class="id" title="var">st</span> <span class="id" title="var">vars</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Halldiff_sat</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Halldiff_l</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Halldiff_sat</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Halldiff_sat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#AllDifferent_sat"><span class="id" title="definition">AllDifferent_sat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">sol</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">Hvars_in_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">Halldiff_l</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="Checker.Utility.html#Sets.sint.elements"><span class="id" title="definition">sint.elements</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#union_sets"><span class="id" title="definition">union_sets</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#materialize_vars_doms"><span class="id" title="definition">materialize_vars_doms</span></a> (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_variables"><span class="id" title="projection">diff_variables</span></a> <span class="id" title="keyword">constr</span>) <span class="id" title="var">doms</span>))) <span class="id" title="keyword">as</span> <span class="id" title="var">domain_union</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Checker.AlldifferentCheck.html#alldiff_conflict_if_union_lt_vars"><span class="id" title="lemma">alldiff_conflict_if_union_lt_vars</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">domain_union</span> := <span class="id" title="var">domain_union</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">domain_union</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Checker.Utility.html#Sets.sint.elements_nodup"><span class="id" title="lemma">sint.elements_nodup</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">vars</span>. <span class="id" title="tactic">clear</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a>, <a class="idref" href="Checker.AlldifferentCheck.html#bounded_vars"><span class="id" title="definition">bounded_vars</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup_filter"><span class="id" title="lemma">NoDup_filter</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup_filter"><span class="id" title="lemma">NoDup_filter</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Checker.Utility.html#Maps.nodup_bindings_keys"><span class="id" title="lemma">nodup_bindings_keys</span></a>. }<br/>
&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">st</span> <span class="id" title="var">domain_union</span> <span class="id" title="var">vars</span>. <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#Sets.sint.elements_in"><span class="id" title="lemma">sint.elements_in</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.AlldifferentCheck.html#union_sets_spec"><span class="id" title="lemma">union_sets_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s</span> &amp; <span class="id" title="var">Hin_mtrl</span> &amp; <span class="id" title="var">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Hin_mtrl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialize_vars_doms"><span class="id" title="definition">materialize_vars_doms</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#ListEx.in_flat_map_option"><span class="id" title="lemma">in_flat_map_option</span></a>. <span class="id" title="tactic">intros</span> (<span class="id" title="var">v</span> &amp; <span class="id" title="var">Hvconstr</span> &amp; <span class="id" title="var">Hmtrl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">v</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#constr_vars"><span class="id" title="definition">constr_vars</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#bounded_vars"><span class="id" title="definition">bounded_vars</span></a> <span class="id" title="var">doms</span>) <span class="id" title="keyword">constr</span>))) <span class="id" title="keyword">as</span> <span class="id" title="var">Hvin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.AlldifferentCheck.html#materialized_in_constr_iff_in_constr_bounded"><span class="id" title="lemma">materialized_in_constr_iff_in_constr_bounded</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">Hvconstr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Hnone</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hnone</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hmtrl</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">Hmtrl</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_map_iff"><span class="id" title="lemma">in_map_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hvin</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">x</span> &amp; <span class="id" title="var">Hxv</span> &amp; <span class="id" title="var">Hxin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">Hxin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.AlldifferentCheck.html#in_materialized_iff_in_dom_for_var"><span class="id" title="lemma">in_materialized_iff_in_dom_for_var</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hmtrl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">x</span> &amp; <span class="id" title="var">Hxin</span> &amp; <span class="id" title="var">Hndom</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_map"><span class="id" title="lemma">in_map</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> := <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hxin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.AlldifferentCheck.html#materialized_in_constr_iff_in_constr_bounded"><span class="id" title="lemma">materialized_in_constr_iff_in_constr_bounded</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hxin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hxin</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hvin</span> <span class="id" title="var">Hmtrl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">s</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hs</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Hmtrl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialize_vars_doms"><span class="id" title="definition">materialize_vars_doms</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#ListEx.in_flat_map_option"><span class="id" title="lemma">in_flat_map_option</span></a>. <span class="id" title="tactic">exists</span> (<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hvin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="Checker.AlldifferentCheck.html#in_materialized_iff_in_dom_for_var"><span class="id" title="lemma">in_materialized_iff_in_dom_for_var</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span> := <span class="id" title="var">n</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hndom</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hvars_in_state</span> <span class="id" title="var">Heqst</span> <span class="id" title="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">domain_union</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.Utility.html#Sets.sint.cardinal_spec"><span class="id" title="lemma">sint.cardinal_spec</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb_lt"><span class="id" title="lemma">Nat.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hconfl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <span class="id" title="var">vars</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f9"><span class="id" title="notation">&gt;=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> (<a class="idref" href="Checker.AlldifferentCheck.html#materialize_vars_doms"><span class="id" title="definition">materialize_vars_doms</span></a> <span class="id" title="keyword">constr</span>.(<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_variables"><span class="id" title="projection">diff_variables</span></a>) <span class="id" title="var">doms</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hconfl</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">vars</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialize_vars_doms"><span class="id" title="definition">materialize_vars_doms</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Checker.Utility.html#ListEx.flat_map_option_as_filter_map"><span class="id" title="lemma">flat_map_option_as_filter_map</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">d</span> := <a class="idref" href="Checker.Utility.html#Sets.sint.empty"><span class="id" title="definition">sint.empty</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length_map"><span class="id" title="lemma">length_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#length_map"><span class="id" title="lemma">length_map</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> := <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup_incl_length"><span class="id" title="lemma">NoDup_incl_length</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup_filter"><span class="id" title="lemma">NoDup_filter</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="keyword">constr</span>.(<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_unique_vars"><span class="id" title="projection">diff_unique_vars</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#filter_In"><span class="id" title="lemma">filter_In</span></a>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Checker.Utility.html#ListEx.filter_f_option"><span class="id" title="definition">filter_f_option</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="Checker.AlldifferentCheck.html#materialized_dom_for_var"><span class="id" title="definition">materialized_dom_for_var</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">s</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmtrl_doms</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">Hinconstr</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Checker.AlldifferentCheck.html#materialized_in_constr_iff_in_constr_bounded"><span class="id" title="lemma">materialized_in_constr_iff_in_constr_bounded</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">Hinconstr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">Hnone</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hnone</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hmtrl_doms</span>; <span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="var_name_inj" class="idref" href="#var_name_inj"><span class="id" title="lemma">var_name_inj</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="l:79" class="idref" href="#l:79"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#l:79"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#l:79"><span class="id" title="variable">l</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup_nil"><span class="id" title="constructor">NoDup_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hnodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hnodup</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span> <span class="id" title="var">l0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#NoDup_cons"><span class="id" title="constructor">NoDup_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#in_map_iff"><span class="id" title="lemma">in_map_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">Haa'</span> &amp; <span class="id" title="var">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Haa'</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="build_alldifferent" class="idref" href="#build_alldifferent"><span class="id" title="definition">build_alldifferent</span></a> (<a id="vs:80" class="idref" href="#vs:80"><span class="id" title="binder">vs</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.AlldifferentConstraint"><span class="id" title="record">AlldifferentConstraint</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="nodup_strs:81" class="idref" href="#nodup_strs:81"><span class="id" title="binder">nodup_strs</span></a> := <a class="idref" href="Checker.Utility.html#Sets.sstr.elements"><span class="id" title="definition">sstr.elements</span></a> (<a class="idref" href="Checker.Utility.html#Sets.sstr.build"><span class="id" title="definition">sstr.build</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vs:80"><span class="id" title="variable">vs</span></a>) <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="nodup_vars:82" class="idref" href="#nodup_vars:82"><span class="id" title="binder">nodup_vars</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Checker.Spec.html#ConstraintDefinitions.var_name"><span class="id" title="constructor">var_name</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#nodup_strs:81"><span class="id" title="variable">nodup_strs</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_variables"><span class="id" title="projection">diff_variables</span></a> := <a class="idref" href="Checker.AlldifferentCheck.html#nodup_vars:82"><span class="id" title="variable">nodup_vars</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ConstraintDefinitions.diff_unique_vars"><span class="id" title="projection">diff_unique_vars</span></a> := <a class="idref" href="Checker.AlldifferentCheck.html#var_name_inj"><span class="id" title="lemma">var_name_inj</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#nodup_strs:81"><span class="id" title="variable">nodup_strs</span></a> (<a class="idref" href="Checker.Utility.html#Sets.sstr.elements_nodup"><span class="id" title="lemma">sstr.elements_nodup</span></a> (<a class="idref" href="Checker.Utility.html#Sets.sstr.build"><span class="id" title="definition">sstr.build</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#vs:80"><span class="id" title="variable">vs</span></a>))<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="constr:83" class="idref" href="#constr:83"><span class="id" title="binder">constr</span></a> := <a class="idref" href="Checker.AlldifferentCheck.html#build_alldifferent"><span class="id" title="definition">build_alldifferent</span></a> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;"x" <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> "y" <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="fact:84" class="idref" href="#fact:84"><span class="id" title="binder">fact</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ProofFacts.i_premises"><span class="id" title="projection">i_premises</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"x"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_eq"><span class="id" title="definition">mk_atm_eq</span></a> 1<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"y"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_eq"><span class="id" title="definition">mk_atm_eq</span></a> 1<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ProofFacts.i_consequent"><span class="id" title="projection">i_consequent</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Checker.AlldifferentCheck.html#alldifferent_checker"><span class="id" title="definition">alldifferent_checker</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#fact:84"><span class="id" title="variable">fact</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#constr:83"><span class="id" title="variable">constr</span></a>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="constr:85" class="idref" href="#constr:85"><span class="id" title="binder">constr</span></a> := <a class="idref" href="Checker.AlldifferentCheck.html#build_alldifferent"><span class="id" title="definition">build_alldifferent</span></a> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;"x" <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> "y" <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="fact:86" class="idref" href="#fact:86"><span class="id" title="binder">fact</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ProofFacts.i_premises"><span class="id" title="projection">i_premises</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"x"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_le"><span class="id" title="definition">mk_atm_le</span></a> 3<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"x"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ge"><span class="id" title="definition">mk_atm_ge</span></a> 0<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"x"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ne"><span class="id" title="definition">mk_atm_ne</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"y"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_eq"><span class="id" title="definition">mk_atm_eq</span></a> 1<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ProofFacts.i_consequent"><span class="id" title="projection">i_consequent</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Checker.AlldifferentCheck.html#alldifferent_checker"><span class="id" title="definition">alldifferent_checker</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#fact:86"><span class="id" title="variable">fact</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#constr:85"><span class="id" title="variable">constr</span></a>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="constr:87" class="idref" href="#constr:87"><span class="id" title="binder">constr</span></a> := <a class="idref" href="Checker.AlldifferentCheck.html#build_alldifferent"><span class="id" title="definition">build_alldifferent</span></a> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;"x" <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> "y" <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> "z" <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="fact:88" class="idref" href="#fact:88"><span class="id" title="binder">fact</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ProofFacts.i_premises"><span class="id" title="projection">i_premises</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"x"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_le"><span class="id" title="definition">mk_atm_le</span></a> 5<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"x"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ne"><span class="id" title="definition">mk_atm_ne</span></a> 4<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"x"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ge"><span class="id" title="definition">mk_atm_ge</span></a> 3<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"y"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_le"><span class="id" title="definition">mk_atm_le</span></a> 5<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"y"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ge"><span class="id" title="definition">mk_atm_ge</span></a> 3<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"y"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ne"><span class="id" title="definition">mk_atm_ne</span></a> 4<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"z"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_le"><span class="id" title="definition">mk_atm_le</span></a> 5<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"z"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ge"><span class="id" title="definition">mk_atm_ge</span></a> 3<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>"z"<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Checker.Domain.html#mk_atm_ne"><span class="id" title="definition">mk_atm_ne</span></a> 4<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Checker.Spec.html#ProofFacts.i_consequent"><span class="id" title="projection">i_consequent</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.20.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Checker.AlldifferentCheck.html#alldifferent_checker"><span class="id" title="definition">alldifferent_checker</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#fact:88"><span class="id" title="variable">fact</span></a> <a class="idref" href="Checker.AlldifferentCheck.html#constr:87"><span class="id" title="variable">constr</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
